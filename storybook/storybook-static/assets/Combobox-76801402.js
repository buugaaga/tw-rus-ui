import{q as te,_ as ue,t as D,a as R,F as pe,j as o}from"./usePropId-97cc893b.js";import{i as Be}from"./use-independent-context.hook-9077e291.js";import{k as se,u as Me,a as Ge,c as He,d as qe,e as De,o as Ue,f as Ke,i as Ze,g as Je,j as Qe,l as Xe}from"./floating-ui.react.esm-6cc99f0f.js";import{r as a}from"./index-76fb7be0.js";import{t as Ye}from"./FormControl.context-bea77a96.js";import{t as ea}from"./InputGroup.context-bea77a96.js";import{a as aa}from"./Spinner-211d531f.js";import{r as ee}from"./use-keypress-dd3b0736.js";import{o as sa}from"./use-vertical-arrows.hook-85ba772b.js";import{c as ta}from"./XMark-22a5a853.js";import{l as la}from"./CaretUpDown-5f3498e4.js";var l;(function(e){e.register="REGISTER",e.reset="RESET",e.single_select="SINGLE_SELECT",e.multi_select="MULTI_SELECT",e.init_multi_select="INIT_MULTI_SELECT",e.search_start="SEARCH_START",e.search_reset="SEARCH_RESET",e.remove_last="REMOVE_LAST"})(l||(l={}));const ia=(e,s)=>{switch(s.type){case l.register:return Object.assign(Object.assign({},e),{options:[...e.options,{label:s.payload.label,value:s.payload.value}]});case l.single_select:if(!s.payload.omitOnChange&&e.onChange&&e.onChange(s.payload.value),s.payload.value===void 0)return e;const u=e.selectedOptions.find(t=>t.value===s.payload.value),r=e.options.find(t=>t.value===s.payload.value);return Object.assign(Object.assign({},e),{search:"",searching:!1,selectedOptions:u&&s.payload.toggle?[]:[r]});case l.multi_select:const c=e.selectedOptions.find(t=>t.value===s.payload.value);let d=e.selectedOptions.filter(t=>t.value!==(c==null?void 0:c.value));if(c&&s.payload.toggle)return!s.payload.omitOnChange&&e.onChange&&e.onChange(d.map(t=>t.value)),Object.assign(Object.assign({},e),{search:"",searching:!1,selectedOptions:d});if(c&&!s.payload.toggle)return e;const i=e.options.find(t=>t.value===s.payload.value);return d=[...e.selectedOptions,i],!s.payload.omitOnChange&&e.onChange&&e.onChange(d.map(t=>t.value)),Object.assign(Object.assign({},e),{search:"",searching:!1,selectedOptions:d});case l.init_multi_select:const p=e.selectedOptions.map(t=>t.value).sort(),v=s.payload.values.sort(),m=p.length===v.length;if(v.every((t,y)=>p[y]===t)&&m)return e;const E=e.options.filter(t=>s.payload.values.includes(t.value));return Object.assign(Object.assign({},e),{selectedOptions:E});case l.remove_last:if(e.onChange){const t=e.selectedOptions.slice(0,-1).map(y=>y.value);e.onChange(e.multiple?t:t[0])}return Object.assign(Object.assign({},e),{search:"",searching:!1,selectedOptions:e.selectedOptions.slice(0,-1)});case l.reset:return e.onChange&&e.onChange(null),Object.assign(Object.assign({},e),{search:"",searching:!1,selectedOptions:[]});case l.search_start:return Object.assign(Object.assign({},e),{search:s.payload.search,searching:!0});case l.search_reset:return Object.assign(Object.assign({},e),{search:"",searching:!1});default:return e}},[na,ge]=Be(),oa={weight:"normal"},le=a.forwardRef((e,s)=>{const u=te("Combobox"),r=Object.assign(Object.assign({},oa),e),{children:c,className:d,heading:i,weight:p}=r,v=ue(r,["children","className","heading","weight"]),m=D(e.id),E=a.useRef(null),t=se([E,s||null]),[y,N]=a.useState(!1),{size:$,state:L,mode:h}=ge(),[_,T]=a.useState(null),[F,w]=a.useState(""),[g,A]=a.useState(0);return a.useEffect(()=>{A(0),T(a.Children.map(c,W=>a.cloneElement(W,Object.assign(Object.assign({},W.props),{ref:S=>{S&&(S==null?void 0:S.getAttribute("aria-hidden"))==="true"&&A(U=>U+1)}}))))},[L.search]),a.useEffect(()=>{N(g===a.Children.count(c))},[c,g]),a.useEffect(()=>{w(u.group({className:d,hidden:y,size:$,mode:h,weight:p}))},[d,y,h,$,u,p]),R(pe,{children:[o("div",Object.assign({id:m,ref:t,"aria-hidden":y,className:F},v,{children:i})),_]})});le.displayName="ComboboxGroup";le.__docgenInfo={description:"",methods:[],displayName:"ComboboxGroup"};function ae(e){return e.trim().normalize("NFD").replace(/\p{Diacritic}/gu,"").toLowerCase()}const ra=({className:e})=>o("svg",Object.assign({className:e,xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",fill:"currentColor",viewBox:"0 0 256 256"},{children:o("path",{d:"M229.66,77.66l-128,128a8,8,0,0,1-11.32,0l-56-56a8,8,0,0,1,11.32-11.32L96,188.69,218.34,66.34a8,8,0,0,1,11.32,11.32Z"})})),ie=a.forwardRef((e,s)=>{const u=te("ComboboxOption"),{value:r,label:c,description:d,media:i}=e,p=!!e.disabled,v=D(e.id),{dispatch:m,externalSearch:E,mode:t,multiple:y,optionColor:N,radius:$,size:L,state:h}=ge(),_=ae(h.search||""),T=ae(c||""),F=ae(d||""),w=!E&&!T.includes(_)&&!F.includes(_),g=h.selectedOptions.findIndex(A=>A.value===r)!==-1;return a.useEffect(()=>{m({type:l.register,payload:{value:r,label:c}}),h.initialValue&&(typeof h.initialValue!="string"||h.initialValue!==r?Array.isArray(h.initialValue)&&h.initialValue.includes(r)&&m({type:l.multi_select,payload:{value:r,omitOnChange:!0}}):m({type:l.single_select,payload:{value:r,omitOnChange:!0}}))},[]),R("button",Object.assign({id:v,ref:s,"aria-selected":g,role:"option",className:u.button({optionColor:N,radius:$,selected:g,hidden:w,size:L,mode:t}),"aria-hidden":w,disabled:p,"aria-disabled":p,onClick:()=>{m(y?{type:l.multi_select,payload:{value:r,toggle:!0}}:{type:l.single_select,payload:{value:r,toggle:!0}})}},{children:[R("div",Object.assign({className:u.optionWrapper()},{children:[i,R("div",Object.assign({className:u.infoWrapper()},{children:[o("span",Object.assign({className:u.label({disabled:p,selected:g})},{children:c})),o("span",Object.assign({className:u.description({disabled:p,selected:g})},{children:d}))]}))]})),g&&o(ra,{className:u.icon({size:L})})]}))});ie.displayName="ComboboxOption";ie.__docgenInfo={description:"",methods:[],displayName:"ComboboxOption"};function ca({offset:e=5}){const[s,u]=a.useState(!1),{x:r,y:c,refs:d,strategy:i,context:p}=Me({open:s,onOpenChange:u,placement:"bottom-start",middleware:[Ue(e),Ke(),Ze(),Je()],whileElementsMounted:Qe}),{getReferenceProps:v,getFloatingProps:m}=Ge([He(p),qe(p,{escapeKey:!1,referencePress:!1}),De(p,{role:"listbox"})]);return a.useMemo(()=>({x:r,y:c,reference:d.setReference,floating:d.setFloating,strategy:i,getFloatingProps:m(),getReferenceProps:v(),open:s,setOpen:u}),[d,m,v,s,i,r,c])}const da={clearable:!0,closeOnEscape:!0,closeOnSelect:!0,color:"dark",disabled:!1,loading:!1,maxHeight:250,minWidth:250,mode:"spacey",multiple:!1,offset:5,optionColor:"gray",radius:"md",searchable:!0,shadow:"none",size:"md",tone:"light",validation:"none",withRing:!0},ne=a.forwardRef((e,s)=>{var u,r,c,d;const i=te("Combobox"),p=Object.assign(Object.assign(Object.assign(Object.assign({},da),Ye()),ea()),e),{children:v,className:m,clearable:E,closeOnEscape:t,closeOnSelect:y,color:N,controlId:$,initialValue:L,leftIcon:h,loading:_,maxHeight:T,minWidth:F,mode:w,multiple:g,offset:A,onChange:W,onSearch:S,optionColor:U,placeholder:he,radius:P,searchable:oe,shadow:B,size:b,tone:I,validation:K,value:z,withRing:Z}=p,me=ue(p,["children","className","clearable","closeOnEscape","closeOnSelect","color","controlId","initialValue","leftIcon","loading","maxHeight","minWidth","mode","multiple","offset","onChange","onSearch","optionColor","placeholder","radius","searchable","shadow","size","tone","validation","value","withRing"]),be=D(e.id),re=a.useId(),fe=D($),j=e.disabled||_,J=!!h,Q=!0,[f,C]=a.useReducer(ia,{multiple:g||!1,initialValue:L,onChange:W,options:[],selectedOptions:[],search:"",searching:!1}),[X,Oe]=a.useState([]),[ve,ye]=a.useState(""),[je,Ce]=a.useState(i.base({className:m,color:N,disabled:j,hasLeftIcon:J,hasRightIcon:Q,radius:P,shadow:B,size:b,tone:I,validation:K,withRing:Z})),[Ne,_e]=a.useState(null),k=a.useRef(null),V=a.useRef(null),M=a.useRef(null),Ee={externalSearch:!!S,mode:w,multiple:g,optionColor:U,radius:P,size:b,state:f,dispatch:C},{x:xe,y:G,reference:Re,floating:we,strategy:Se,getFloatingProps:Ie,open:O,setOpen:H}=ca({offset:A}),ze=se([Re,k,s||null]),$e=se([V,we]),Le=i.wrapper({disabled:j}),Ae=i.noResults({size:b}),Pe=h?i.icon({tone:I,size:b,className:h.props.className}):null,Te=i.leftIconWrapper({size:b}),ce=i.icon({tone:I,size:b}),Y=i.rightIconWrapper({color:N,size:b});a.useEffect(()=>{k.current&&_e(k.current.getBoundingClientRect().width)},[]),a.useEffect(()=>{z?g&&Array.isArray(z)&&z.length>0?C({type:l.init_multi_select,payload:{values:z}}):g||typeof z!="string"||C({type:l.single_select,payload:{value:z}}):C({type:l.reset,payload:null})},[z,g]),a.useEffect(()=>{var n;O&&((n=M.current)===null||n===void 0||n.focus()),de()},[O]),ee("Escape",!0,()=>{C({type:l.search_reset,payload:null}),O&&t&&H(!1)}),ee("Backspace",O,()=>{f.search||C({type:l.remove_last,payload:null})}),ee("Enter",!0,()=>{var n;if(!f.searching)return;const x=(n=V.current)===null||n===void 0?void 0:n.querySelector('button[aria-hidden="false"]:not([aria-disabled="true"])');x&&x.click()}),a.useLayoutEffect(()=>{setTimeout(()=>{V.current&&Oe(Array.from(V.current.querySelectorAll('button[aria-hidden="false"][aria-disabled="false"]')))},1),de()},[f.search]),a.useEffect(()=>{O&&y&&H(!1)},[f.selectedOptions]),sa(X,O);const Fe=o("div",Object.assign({className:je},{children:R("div",Object.assign({className:i.tagWrapper({size:b})},{children:[g&&((u=f.selectedOptions)===null||u===void 0?void 0:u.map((n,x)=>R("div",Object.assign({className:i.tag({disabled:j,radius:P,size:b,tone:I})},{children:[o("button",Object.assign({type:"button",disabled:j,"aria-label":`Remove ${n.label}`,className:i.tagButton({color:N,disabled:j}),onClick:q=>{C({type:l.multi_select,payload:{value:n.value,toggle:!0}}),q.stopPropagation()}},{children:o("span",Object.assign({className:i.tagButtonIcon()},{children:"âœ•"}))})),o("span",{children:n.label})]}),`label-${x}`))),(!g||O||f.selectedOptions.length===0)&&o("input",{id:fe,ref:M,disabled:j,className:i.input({size:b}),role:"combobox","aria-controls":re,"aria-autocomplete":oe?"both":"list","aria-haspopup":"listbox","aria-expanded":O,value:f.searching?f.search:(g?"":(r=f.selectedOptions[0])===null||r===void 0?void 0:r.label)||"",placeholder:f.selectedOptions.length?"":he,readOnly:!oe,autoComplete:"off",onBlur:()=>C({type:l.search_reset,payload:null}),onChange:n=>{C({type:l.search_start,payload:{search:n.target.value}}),S&&S(n.target.value),O||H(!0)},type:"text"})]}))})),ke=I==="solid"?"slate":"gray",de=()=>{V.current&&ye(i.list({size:b,open:O,mode:w,radius:P,shadow:B}))};return a.useEffect(()=>{var n,x;if(!(!((n=k.current)===null||n===void 0)&&n.dataset))return;const q=Object.assign({},(x=k.current)===null||x===void 0?void 0:x.dataset),Ve=q.hasOwnProperty("hasLeftElement"),We=q.hasOwnProperty("hasRightElement");Ce(i.base({className:m,color:N,disabled:j,hasLeftElement:Ve,hasLeftIcon:J,hasRightElement:We,hasRightIcon:Q,radius:P,shadow:B,size:b,tone:I,validation:K,withRing:Z}))},[m,N,j,J,Q,P,B,b,i,I,K,Z]),o(pe,{children:R("div",Object.assign({id:be,ref:ze,className:Le,onClick:()=>{var n;O||j||H(!0),(n=M==null?void 0:M.current)===null||n===void 0||n.focus()}},me,{children:[h&&o("span",Object.assign({className:Te},{children:a.cloneElement(h,{className:Pe})})),Fe,_&&o("span",Object.assign({className:Y},{children:o(aa,{size:b,color:ke})})),!_&&E&&((c=f.selectedOptions)===null||c===void 0?void 0:c.length)>0&&o("button",Object.assign({"aria-label":"Clear",type:"button",disabled:j,onClick:n=>{C({type:l.reset,payload:null}),C({type:l.search_reset,payload:null}),n.stopPropagation()},className:Y},{children:o(ta,{className:ce})})),!_&&(!E||((d=f.selectedOptions)===null||d===void 0?void 0:d.length)===0)&&o("div",Object.assign({className:Y},{children:o(la,{className:ce})})),o(na,Object.assign({value:Ee},{children:o(Xe,{children:R("div",Object.assign({id:re,role:"listbox",ref:$e,className:ve,style:{display:O?"block":"none",opacity:O&&!j?1:0,maxHeight:`${T}px`,minWidth:`${F}px`,maxWidth:`${Ne}px`,position:Se,top:G&&G>0&&G!==1/0?G:0,left:xe||0}},Ie,{children:[(X==null?void 0:X.length)===0&&f.searching&&o("div",Object.assign({className:Ae},{children:"No results"})),v]}))})}))]}))})});ne.displayName="Combobox";const Ca=Object.assign(ne,{Group:le,Option:ie});ne.__docgenInfo={description:"",methods:[],displayName:"Combobox"};export{Ca as E};
//# sourceMappingURL=Combobox-76801402.js.map
